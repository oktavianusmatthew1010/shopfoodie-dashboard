{"version":3,"file":"index.js","sources":["../../src/models.ts","../../node_modules/tslib/tslib.es6.js","../../src/model-utils.ts","../../src/util/websocket-browser.ts","../../src/util/websocket-client.ts","../../src/util/auth.ts","../../src/client.ts"],"sourcesContent":["// Copyright (c) Microsoft Corporation.\r\n// Licensed under the MIT License.\r\n\r\nexport type Voice = \"alloy\" | \"shimmer\" | \"echo\";\r\nexport type AudioFormat = \"pcm16\" | \"g711-ulaw\" | \"g711-alaw\";\r\nexport type Modality = \"text\" | \"audio\";\r\n\r\nexport interface NoTurnDetection {\r\n  type: \"none\";\r\n}\r\n\r\nexport interface ServerVAD {\r\n  type: \"server_vad\";\r\n  threshold?: number;\r\n  prefix_padding_ms?: number;\r\n  silence_duration_ms?: number;\r\n}\r\n\r\nexport type TurnDetection = NoTurnDetection | ServerVAD;\r\n\r\nexport interface FunctionToolChoice {\r\n  type: \"function\";\r\n  function: string;\r\n}\r\n\r\nexport type ToolChoice = \"auto\" | \"none\" | \"required\" | FunctionToolChoice;\r\n\r\nexport type MessageRole = \"system\" | \"assistant\" | \"user\";\r\n\r\nexport interface InputAudioTranscription {\r\n  model: \"whisper-1\";\r\n}\r\n\r\nexport interface ClientMessageBase {\r\n  event_id?: string;\r\n}\r\n\r\nexport type ToolsDefinition = Record<string, any>[];\r\n\r\nexport interface SessionUpdateParams {\r\n  model?: string;\r\n  modalities?: Modality[];\r\n  voice?: Voice;\r\n  instructions?: string;\r\n  input_audio_format?: AudioFormat;\r\n  output_audio_format?: AudioFormat;\r\n  input_audio_transcription?: InputAudioTranscription;\r\n  turn_detection?: TurnDetection;\r\n  tools?: ToolsDefinition;\r\n  tool_choice?: ToolChoice;\r\n  temperature?: number;\r\n  max_response_output_tokens?: number;\r\n}\r\n\r\nexport interface SessionUpdateMessage extends ClientMessageBase {\r\n  type: \"session.update\";\r\n  session: SessionUpdateParams;\r\n}\r\n\r\nexport interface InputAudioBufferAppendMessage extends ClientMessageBase {\r\n  type: \"input_audio_buffer.append\";\r\n  audio: string;\r\n}\r\n\r\nexport interface InputAudioBufferCommitMessage extends ClientMessageBase {\r\n  type: \"input_audio_buffer.commit\";\r\n}\r\n\r\nexport interface InputAudioBufferClearMessage extends ClientMessageBase {\r\n  type: \"input_audio_buffer.clear\";\r\n}\r\n\r\nexport const MessageItemType = \"message\" as const;\r\nexport type MessageItemType = typeof MessageItemType;\r\n\r\nexport interface InputTextContentPart {\r\n  type: \"input_text\";\r\n  text: string;\r\n}\r\n\r\nexport interface InputAudioContentPart {\r\n  type: \"input_audio\";\r\n  audio: string;\r\n  transcript?: string;\r\n}\r\n\r\nexport interface OutputTextContentPart {\r\n  type: \"text\";\r\n  text: string;\r\n}\r\n\r\nexport type SystemContentPart = InputTextContentPart;\r\nexport type UserContentPart = InputTextContentPart | InputAudioContentPart;\r\nexport type AssistantContentPart = OutputTextContentPart;\r\n\r\nexport type ItemParamStatus = \"completed\" | \"incomplete\";\r\n\r\nexport interface SystemMessageItem {\r\n  type: MessageItemType;\r\n  role: \"system\";\r\n  id?: string;\r\n  content: SystemContentPart[];\r\n  status?: ItemParamStatus;\r\n}\r\n\r\nexport interface UserMessageItem {\r\n  type: MessageItemType;\r\n  role: \"user\";\r\n  id?: string;\r\n  content: UserContentPart[];\r\n  status?: ItemParamStatus;\r\n}\r\n\r\nexport interface AssistantMessageItem {\r\n  type: MessageItemType;\r\n  role: \"assistant\";\r\n  id?: string;\r\n  content: AssistantContentPart[];\r\n  status?: ItemParamStatus;\r\n}\r\n\r\nexport type MessageItem =\r\n  | SystemMessageItem\r\n  | UserMessageItem\r\n  | AssistantMessageItem;\r\n\r\nexport interface FunctionCallItem {\r\n  type: \"function_call\";\r\n  id?: string;\r\n  name: string;\r\n  call_id: string;\r\n  arguments: string;\r\n  status?: ItemParamStatus;\r\n}\r\n\r\nexport interface FunctionCallOutputItem {\r\n  type: \"function_call_output\";\r\n  id?: string;\r\n  call_id: string;\r\n  output: string;\r\n  status?: ItemParamStatus;\r\n}\r\n\r\nexport type Item = MessageItem | FunctionCallItem | FunctionCallOutputItem;\r\n\r\nexport interface ItemCreateMessage extends ClientMessageBase {\r\n  type: \"conversation.item.create\";\r\n  previous_item_id?: string;\r\n  item: Item;\r\n}\r\n\r\nexport interface ItemTruncateMessage extends ClientMessageBase {\r\n  type: \"conversation.item.truncate\";\r\n  item_id: string;\r\n  content_index: number;\r\n  audio_end_ms: number;\r\n}\r\n\r\nexport interface ItemDeleteMessage extends ClientMessageBase {\r\n  type: \"conversation.item.delete\";\r\n  item_id: string;\r\n}\r\n\r\nexport interface ResponseCreateParams {\r\n  commit: boolean;\r\n  cancel_previous: boolean;\r\n  append_input_items?: Item[];\r\n  input_items?: Item[];\r\n  instructions?: string;\r\n  modalities?: Modality[];\r\n  voice?: Voice;\r\n  temperature?: number;\r\n  max_output_tokens?: number;\r\n  tools?: ToolsDefinition;\r\n  tool_choice?: ToolChoice;\r\n  output_audio_format?: AudioFormat;\r\n}\r\n\r\nexport interface ResponseCreateMessage extends ClientMessageBase {\r\n  type: \"response.create\";\r\n  response?: ResponseCreateParams;\r\n}\r\n\r\nexport interface ResponseCancelMessage extends ClientMessageBase {\r\n  type: \"response.cancel\";\r\n}\r\n\r\nexport interface RealtimeError {\r\n  message: string;\r\n  type?: string;\r\n  code?: string;\r\n  param?: string;\r\n  event_id?: string;\r\n}\r\n\r\nexport interface ServerMessageBase {\r\n  event_id: string;\r\n}\r\n\r\nexport interface ErrorMessage extends ServerMessageBase {\r\n  type: \"error\";\r\n  error: RealtimeError;\r\n}\r\n\r\nexport interface Session {\r\n  id: string;\r\n  model: string;\r\n  modalities: Modality[];\r\n  instructions: string;\r\n  voice: Voice;\r\n  input_audio_format: AudioFormat;\r\n  output_audio_format: AudioFormat;\r\n  input_audio_transcription?: InputAudioTranscription;\r\n  turn_detection: TurnDetection;\r\n  tools: ToolsDefinition;\r\n  tool_choice: ToolChoice;\r\n  temperature: number;\r\n  max_response_output_tokens?: number;\r\n}\r\n\r\nexport interface SessionCreatedMessage extends ServerMessageBase {\r\n  type: \"session.created\";\r\n  session: Session;\r\n}\r\n\r\nexport interface SessionUpdatedMessage extends ServerMessageBase {\r\n  type: \"session.updated\";\r\n  session: Session;\r\n}\r\n\r\nexport interface InputAudioBufferCommittedMessage extends ServerMessageBase {\r\n  type: \"input_audio_buffer.committed\";\r\n  previous_item_id?: string;\r\n  item_id: string;\r\n}\r\n\r\nexport interface InputAudioBufferClearedMessage extends ServerMessageBase {\r\n  type: \"input_audio_buffer.cleared\";\r\n}\r\n\r\nexport interface InputAudioBufferSpeechStartedMessage\r\n  extends ServerMessageBase {\r\n  type: \"input_audio_buffer.speech_started\";\r\n  audio_start_ms: number;\r\n  item_id: string;\r\n}\r\n\r\nexport interface InputAudioBufferSpeechStoppedMessage\r\n  extends ServerMessageBase {\r\n  type: \"input_audio_buffer.speech_stopped\";\r\n  audio_end_ms: number;\r\n  item_id: string;\r\n}\r\n\r\nexport type ResponseItemStatus = \"in_progress\" | \"completed\" | \"incomplete\";\r\n\r\nexport interface ResponseItemInputTextContentPart {\r\n  type: \"input_text\";\r\n  text: string;\r\n}\r\n\r\nexport interface ResponseItemInputAudioContentPart {\r\n  type: \"input_audio\";\r\n  transcript?: string;\r\n}\r\n\r\nexport interface ResponseItemTextContentPart {\r\n  type: \"text\";\r\n  text: string;\r\n}\r\n\r\nexport interface ResponseItemAudioContentPart {\r\n  type: \"audio\";\r\n  transcript?: string;\r\n}\r\n\r\nexport type ResponseItemContentPart =\r\n  | ResponseItemInputTextContentPart\r\n  | ResponseItemInputAudioContentPart\r\n  | ResponseItemTextContentPart\r\n  | ResponseItemAudioContentPart;\r\n\r\nexport interface ResponseItemBase {\r\n  id?: string;\r\n  status: ResponseItemStatus;\r\n}\r\n\r\nexport interface ResponseMessageItem extends ResponseItemBase {\r\n  type: MessageItemType;\r\n  role: MessageRole;\r\n  content: ResponseItemContentPart[];\r\n}\r\n\r\nexport interface ResponseFunctionCallItem extends ResponseItemBase {\r\n  type: \"function_call\";\r\n  name: string;\r\n  call_id: string;\r\n  arguments: string;\r\n}\r\n\r\nexport interface ResponseFunctionCallOutputItem extends ResponseItemBase {\r\n  type: \"function_call_output\";\r\n  call_id: string;\r\n  output: string;\r\n}\r\n\r\nexport type ResponseItem =\r\n  | ResponseMessageItem\r\n  | ResponseFunctionCallItem\r\n  | ResponseFunctionCallOutputItem;\r\n\r\nexport interface ItemCreatedMessage extends ServerMessageBase {\r\n  type: \"conversation.item.created\";\r\n  previous_item_id?: string;\r\n  item: ResponseItem;\r\n}\r\n\r\nexport interface ItemTruncatedMessage extends ServerMessageBase {\r\n  type: \"conversation.item.truncated\";\r\n  item_id: string;\r\n  content_index: number;\r\n  audio_end_ms: number;\r\n}\r\n\r\nexport interface ItemDeletedMessage extends ServerMessageBase {\r\n  type: \"conversation.item.deleted\";\r\n  item_id: string;\r\n}\r\n\r\nexport interface ItemInputAudioTranscriptionCompletedMessage\r\n  extends ServerMessageBase {\r\n  type: \"conversation.item.input_audio_transcription.completed\";\r\n  item_id: string;\r\n  content_index: number;\r\n  transcript: string;\r\n}\r\n\r\nexport interface ItemInputAudioTranscriptionFailedMessage\r\n  extends ServerMessageBase {\r\n  type: \"conversation.item.input_audio_transcription.failed\";\r\n  item_id: string;\r\n  content_index: number;\r\n  error: RealtimeError;\r\n}\r\n\r\nexport type ResponseStatus =\r\n  | \"in_progress\"\r\n  | \"completed\"\r\n  | \"cancelled\"\r\n  | \"incomplete\"\r\n  | \"failed\";\r\n\r\nexport interface ResponseCancelledDetails {\r\n  type: \"cancelled\";\r\n  reason: \"turn_detected\" | \"client_cancelled\";\r\n}\r\n\r\nexport interface ResponseIncompleteDetails {\r\n  type: \"incomplete\";\r\n  reason: \"max_output_tokens\" | \"content_filter\";\r\n}\r\n\r\nexport interface ResponseFailedDetails {\r\n  type: \"failed\";\r\n  error: RealtimeError;\r\n}\r\n\r\nexport type ResponseStatusDetails =\r\n  | ResponseCancelledDetails\r\n  | ResponseIncompleteDetails\r\n  | ResponseFailedDetails;\r\n\r\nexport interface Usage {\r\n  total_tokens: number;\r\n  input_tokens: number;\r\n  output_tokens: number;\r\n}\r\n\r\nexport interface Response {\r\n  id: string;\r\n  status: ResponseStatus;\r\n  status_details?: ResponseStatusDetails;\r\n  output: ResponseItem[];\r\n  usage?: Usage;\r\n}\r\n\r\nexport interface ResponseCreatedMessage extends ServerMessageBase {\r\n  type: \"response.created\";\r\n  response: Response;\r\n}\r\n\r\nexport interface ResponseDoneMessage extends ServerMessageBase {\r\n  type: \"response.done\";\r\n  response: Response;\r\n}\r\n\r\nexport interface ResponseOutputItemAddedMessage extends ServerMessageBase {\r\n  type: \"response.output_item.added\";\r\n  response_id: string;\r\n  output_index: number;\r\n  item: ResponseItem;\r\n}\r\n\r\nexport interface ResponseOutputItemDoneMessage extends ServerMessageBase {\r\n  type: \"response.output_item.done\";\r\n  response_id: string;\r\n  output_index: number;\r\n  item: ResponseItem;\r\n}\r\n\r\nexport interface ResponseContentPartAddedMessage extends ServerMessageBase {\r\n  type: \"response.content_part.added\";\r\n  response_id: string;\r\n  item_id: string;\r\n  output_index: number;\r\n  content_index: number;\r\n  part: ResponseItemContentPart;\r\n}\r\n\r\nexport interface ResponseContentPartDoneMessage extends ServerMessageBase {\r\n  type: \"response.content_part.done\";\r\n  response_id: string;\r\n  item_id: string;\r\n  output_index: number;\r\n  content_index: number;\r\n  part: ResponseItemContentPart;\r\n}\r\n\r\nexport interface ResponseTextDeltaMessage extends ServerMessageBase {\r\n  type: \"response.text.delta\";\r\n  response_id: string;\r\n  item_id: string;\r\n  output_index: number;\r\n  content_index: number;\r\n  delta: string;\r\n}\r\n\r\nexport interface ResponseTextDoneMessage extends ServerMessageBase {\r\n  type: \"response.text.done\";\r\n  response_id: string;\r\n  item_id: string;\r\n  output_index: number;\r\n  content_index: number;\r\n  text: string;\r\n}\r\n\r\nexport interface ResponseAudioTranscriptDeltaMessage extends ServerMessageBase {\r\n  type: \"response.audio_transcript.delta\";\r\n  response_id: string;\r\n  item_id: string;\r\n  output_index: number;\r\n  content_index: number;\r\n  delta: string;\r\n}\r\n\r\nexport interface ResponseAudioTranscriptDoneMessage extends ServerMessageBase {\r\n  type: \"response.audio_transcript.done\";\r\n  response_id: string;\r\n  item_id: string;\r\n  output_index: number;\r\n  content_index: number;\r\n  transcript: string;\r\n}\r\n\r\nexport interface ResponseAudioDeltaMessage extends ServerMessageBase {\r\n  type: \"response.audio.delta\";\r\n  response_id: string;\r\n  item_id: string;\r\n  output_index: number;\r\n  content_index: number;\r\n  delta: string;\r\n}\r\n\r\nexport interface ResponseAudioDoneMessage extends ServerMessageBase {\r\n  type: \"response.audio.done\";\r\n  response_id: string;\r\n  item_id: string;\r\n  output_index: number;\r\n  content_index: number;\r\n}\r\n\r\nexport interface ResponseFunctionCallArgumentsDeltaMessage\r\n  extends ServerMessageBase {\r\n  type: \"response.function_call_arguments.delta\";\r\n  response_id: string;\r\n  item_id: string;\r\n  output_index: number;\r\n  call_id: string;\r\n  delta: string;\r\n}\r\n\r\nexport interface ResponseFunctionCallArgumentsDoneMessage\r\n  extends ServerMessageBase {\r\n  type: \"response.function_call_arguments.done\";\r\n  response_id: string;\r\n  item_id: string;\r\n  output_index: number;\r\n  call_id: string;\r\n  name: string;\r\n  arguments: string;\r\n}\r\n\r\nexport interface RateLimits {\r\n  name: string;\r\n  limit: number;\r\n  remaining: number;\r\n  reset_seconds: number;\r\n}\r\n\r\nexport interface RateLimitsUpdatedMessage extends ServerMessageBase {\r\n  type: \"rate_limits.updated\";\r\n  rate_limits: RateLimits[];\r\n}\r\n\r\nexport type UserMessageType =\r\n  | SessionUpdateMessage\r\n  | InputAudioBufferAppendMessage\r\n  | InputAudioBufferCommitMessage\r\n  | InputAudioBufferClearMessage\r\n  | ItemCreateMessage\r\n  | ItemTruncateMessage\r\n  | ItemDeleteMessage\r\n  | ResponseCreateMessage\r\n  | ResponseCancelMessage;\r\n\r\nexport type ServerMessageType =\r\n  | ErrorMessage\r\n  | SessionCreatedMessage\r\n  | SessionUpdatedMessage\r\n  | InputAudioBufferCommittedMessage\r\n  | InputAudioBufferClearedMessage\r\n  | InputAudioBufferSpeechStartedMessage\r\n  | InputAudioBufferSpeechStoppedMessage\r\n  | ItemCreatedMessage\r\n  | ItemTruncatedMessage\r\n  | ItemDeletedMessage\r\n  | ItemInputAudioTranscriptionCompletedMessage\r\n  | ItemInputAudioTranscriptionFailedMessage\r\n  | ResponseCreatedMessage\r\n  | ResponseDoneMessage\r\n  | ResponseOutputItemAddedMessage\r\n  | ResponseOutputItemDoneMessage\r\n  | ResponseContentPartAddedMessage\r\n  | ResponseContentPartDoneMessage\r\n  | ResponseTextDeltaMessage\r\n  | ResponseTextDoneMessage\r\n  | ResponseAudioTranscriptDeltaMessage\r\n  | ResponseAudioTranscriptDoneMessage\r\n  | ResponseAudioDeltaMessage\r\n  | ResponseAudioDoneMessage\r\n  | ResponseFunctionCallArgumentsDeltaMessage\r\n  | ResponseFunctionCallArgumentsDoneMessage\r\n  | RateLimitsUpdatedMessage;\r\n","/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise, SuppressedError, Symbol, Iterator */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __esDecorate(ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\r\n    function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\r\n    var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\r\n    var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\r\n    var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\r\n    var _, done = false;\r\n    for (var i = decorators.length - 1; i >= 0; i--) {\r\n        var context = {};\r\n        for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\r\n        for (var p in contextIn.access) context.access[p] = contextIn.access[p];\r\n        context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\r\n        var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\r\n        if (kind === \"accessor\") {\r\n            if (result === void 0) continue;\r\n            if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\r\n            if (_ = accept(result.get)) descriptor.get = _;\r\n            if (_ = accept(result.set)) descriptor.set = _;\r\n            if (_ = accept(result.init)) initializers.unshift(_);\r\n        }\r\n        else if (_ = accept(result)) {\r\n            if (kind === \"field\") initializers.unshift(_);\r\n            else descriptor[key] = _;\r\n        }\r\n    }\r\n    if (target) Object.defineProperty(target, contextIn.name, descriptor);\r\n    done = true;\r\n};\r\n\r\nexport function __runInitializers(thisArg, initializers, value) {\r\n    var useValue = arguments.length > 2;\r\n    for (var i = 0; i < initializers.length; i++) {\r\n        value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\r\n    }\r\n    return useValue ? value : void 0;\r\n};\r\n\r\nexport function __propKey(x) {\r\n    return typeof x === \"symbol\" ? x : \"\".concat(x);\r\n};\r\n\r\nexport function __setFunctionName(f, name, prefix) {\r\n    if (typeof name === \"symbol\") name = name.description ? \"[\".concat(name.description, \"]\") : \"\";\r\n    return Object.defineProperty(f, \"name\", { configurable: true, value: prefix ? \"\".concat(prefix, \" \", name) : name });\r\n};\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g = Object.create((typeof Iterator === \"function\" ? Iterator : Object).prototype);\r\n    return g.next = verb(0), g[\"throw\"] = verb(1), g[\"return\"] = verb(2), typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    var desc = Object.getOwnPropertyDescriptor(m, k);\r\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\r\n        desc = { enumerable: true, get: function() { return m[k]; } };\r\n    }\r\n    Object.defineProperty(o, k2, desc);\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = Object.create((typeof AsyncIterator === \"function\" ? AsyncIterator : Object).prototype), verb(\"next\"), verb(\"throw\"), verb(\"return\", awaitReturn), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function awaitReturn(f) { return function (v) { return Promise.resolve(v).then(f, reject); }; }\r\n    function verb(n, f) { if (g[n]) { i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; if (f) i[n] = f(i[n]); } }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: false } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n\r\nexport function __classPrivateFieldIn(state, receiver) {\r\n    if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\r\n    return typeof state === \"function\" ? receiver === state : state.has(receiver);\r\n}\r\n\r\nexport function __addDisposableResource(env, value, async) {\r\n    if (value !== null && value !== void 0) {\r\n        if (typeof value !== \"object\" && typeof value !== \"function\") throw new TypeError(\"Object expected.\");\r\n        var dispose, inner;\r\n        if (async) {\r\n            if (!Symbol.asyncDispose) throw new TypeError(\"Symbol.asyncDispose is not defined.\");\r\n            dispose = value[Symbol.asyncDispose];\r\n        }\r\n        if (dispose === void 0) {\r\n            if (!Symbol.dispose) throw new TypeError(\"Symbol.dispose is not defined.\");\r\n            dispose = value[Symbol.dispose];\r\n            if (async) inner = dispose;\r\n        }\r\n        if (typeof dispose !== \"function\") throw new TypeError(\"Object not disposable.\");\r\n        if (inner) dispose = function() { try { inner.call(this); } catch (e) { return Promise.reject(e); } };\r\n        env.stack.push({ value: value, dispose: dispose, async: async });\r\n    }\r\n    else if (async) {\r\n        env.stack.push({ async: true });\r\n    }\r\n    return value;\r\n\r\n}\r\n\r\nvar _SuppressedError = typeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\r\n    var e = new Error(message);\r\n    return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\r\n};\r\n\r\nexport function __disposeResources(env) {\r\n    function fail(e) {\r\n        env.error = env.hasError ? new _SuppressedError(e, env.error, \"An error was suppressed during disposal.\") : e;\r\n        env.hasError = true;\r\n    }\r\n    var r, s = 0;\r\n    function next() {\r\n        while (r = env.stack.pop()) {\r\n            try {\r\n                if (!r.async && s === 1) return s = 0, env.stack.push(r), Promise.resolve().then(next);\r\n                if (r.dispose) {\r\n                    var result = r.dispose.call(r.value);\r\n                    if (r.async) return s |= 2, Promise.resolve(result).then(next, function(e) { fail(e); return next(); });\r\n                }\r\n                else s |= 1;\r\n            }\r\n            catch (e) {\r\n                fail(e);\r\n            }\r\n        }\r\n        if (s === 1) return env.hasError ? Promise.reject(env.error) : Promise.resolve();\r\n        if (env.hasError) throw env.error;\r\n    }\r\n    return next();\r\n}\r\n\r\nexport default {\r\n    __extends: __extends,\r\n    __assign: __assign,\r\n    __rest: __rest,\r\n    __decorate: __decorate,\r\n    __param: __param,\r\n    __metadata: __metadata,\r\n    __awaiter: __awaiter,\r\n    __generator: __generator,\r\n    __createBinding: __createBinding,\r\n    __exportStar: __exportStar,\r\n    __values: __values,\r\n    __read: __read,\r\n    __spread: __spread,\r\n    __spreadArrays: __spreadArrays,\r\n    __spreadArray: __spreadArray,\r\n    __await: __await,\r\n    __asyncGenerator: __asyncGenerator,\r\n    __asyncDelegator: __asyncDelegator,\r\n    __asyncValues: __asyncValues,\r\n    __makeTemplateObject: __makeTemplateObject,\r\n    __importStar: __importStar,\r\n    __importDefault: __importDefault,\r\n    __classPrivateFieldGet: __classPrivateFieldGet,\r\n    __classPrivateFieldSet: __classPrivateFieldSet,\r\n    __classPrivateFieldIn: __classPrivateFieldIn,\r\n    __addDisposableResource: __addDisposableResource,\r\n    __disposeResources: __disposeResources,\r\n};\r\n","import { ServerMessageType } from \"./models\";\r\n\r\nconst isRealtimeEvent = (message: unknown): message is { type: string } =>\r\n  typeof message === \"object\" && message !== null && \"type\" in message;\r\n\r\nexport const isServerMessageType = (\r\n  message: unknown,\r\n): message is ServerMessageType =>\r\n  isRealtimeEvent(message) &&\r\n  [\r\n    \"error\",\r\n    \"session.created\",\r\n    \"session.updated\",\r\n    \"input_audio_buffer.committed\",\r\n    \"input_audio_buffer.cleared\",\r\n    \"input_audio_buffer.speech_started\",\r\n    \"input_audio_buffer.speech_stopped\",\r\n    \"conversation.item.created\",\r\n    \"conversation.item.truncated\",\r\n    \"conversation.item.deleted\",\r\n    \"conversation.item.input_audio_transcription.completed\",\r\n    \"conversation.item.input_audio_transcription.failed\",\r\n    \"response.created\",\r\n    \"response.done\",\r\n    \"response.output_item.added\",\r\n    \"response.output_item.done\",\r\n    \"response.content_part.added\",\r\n    \"response.content_part.done\",\r\n    \"response.text.delta\",\r\n    \"response.text.done\",\r\n    \"response.audio_transcript.delta\",\r\n    \"response.audio_transcript.done\",\r\n    \"response.audio.delta\",\r\n    \"response.audio.done\",\r\n    \"response.function_call_arguments.delta\",\r\n    \"response.function_call_arguments.done\",\r\n    \"rate_limits.updated\",\r\n  ].includes(message.type);\r\n","// Copyright (c) Microsoft Corporation.\r\n// Licensed under the MIT License.\r\n\r\ntype _WS = WebSocket;\r\nconst _WS = WebSocket;\r\nconst _CloseEvent = CloseEvent;\r\nconst _ErrorEvent = ErrorEvent;\r\nconst _MessageEvent = MessageEvent;\r\nexport {\r\n  _WS as WebSocket,\r\n  _MessageEvent as MessageEvent,\r\n  _CloseEvent as CloseEvent,\r\n  _ErrorEvent as ErrorEvent,\r\n};\r\n\r\nexport const sendMessage = (\r\n  socket: WebSocket,\r\n  message: string | ArrayBufferLike | ArrayBufferView,\r\n): Promise<void> => {\r\n  if (socket.readyState !== WebSocket.OPEN) {\r\n    return Promise.reject(new Error(\"Socket is not open\"));\r\n  }\r\n  socket.send(message);\r\n  return Promise.resolve();\r\n};\r\n","// Copyright (c) Microsoft Corporation.\r\n// Licensed under the MIT License.\r\n\r\nimport {\r\n  WebSocket,\r\n  ErrorEvent,\r\n  CloseEvent,\r\n  MessageEvent,\r\n  sendMessage,\r\n} from \"./websocket\";\r\n\r\ntype ResolveFn<T> = (value: IteratorResult<T>) => void;\r\ntype RejectFn<E> = (reason: E) => void;\r\n\r\nexport type ValidatorResult<T> =\r\n  | { success: true; message: T }\r\n  | { success: false; error: Error };\r\n\r\nexport const validationSuccess = <T>(message: T): ValidatorResult<T> => ({\r\n  success: true,\r\n  message,\r\n});\r\nexport const validationError = <T>(error: Error): ValidatorResult<T> => ({\r\n  success: false,\r\n  error,\r\n});\r\nconst isValidatorSuccess = <T>(\r\n  result: ValidatorResult<T>,\r\n): result is { success: true; message: T } => result.success;\r\n\r\nexport type ValidateProtocolMessage<T> = (\r\n  message: MessageEvent,\r\n) => ValidatorResult<T>;\r\nexport type SerializeMessage<T> = (\r\n  message: T,\r\n) => string | ArrayBufferLike | ArrayBufferView;\r\n\r\nexport type WebSocketPolicy = (\r\n  ConnectionSettings: ConnectionSettings,\r\n) => Promise<ConnectionSettings>;\r\n\r\nexport interface ConnectionSettings {\r\n  uri: URL;\r\n  protocols?: string[];\r\n  policy?: WebSocketPolicy;\r\n}\r\n\r\nexport interface MessageProtocolHandler<U, D> {\r\n  validate: ValidateProtocolMessage<D>;\r\n  serialize: SerializeMessage<U>;\r\n}\r\n\r\nexport class WebSocketClient<U, D> implements AsyncIterable<D> {\r\n  private socket: WebSocket;\r\n  private connectedPromise: Promise<void>;\r\n  private closedPromise: Promise<void> | undefined = undefined;\r\n  private error: Error | undefined;\r\n  private messageQueue: D[] = [];\r\n  private validate: ValidateProtocolMessage<D>;\r\n  private serialize: SerializeMessage<U>;\r\n\r\n  private receiverQueue: [ResolveFn<D>, RejectFn<Error>][] = [];\r\n  private done: boolean = false;\r\n\r\n  constructor(\r\n    settings: ConnectionSettings,\r\n    handler: MessageProtocolHandler<U, D>,\r\n  ) {\r\n    this.validate = handler.validate;\r\n    this.serialize = handler.serialize;\r\n    this.connectedPromise = new Promise(async (resolve, reject) => {\r\n      const { uri, protocols } =\r\n        settings.policy === undefined\r\n          ? settings\r\n          : await settings.policy(settings);\r\n      this.socket = new WebSocket(uri.toString(), protocols);\r\n      this.socket.onopen = () => {\r\n        this.socket.onmessage = this.getMessageHandler();\r\n        this.closedPromise = new Promise((resolve) => {\r\n          this.socket.onclose = this.getClosedHandler(resolve);\r\n        });\r\n        this.socket.onerror = this.handleError;\r\n        resolve();\r\n      };\r\n      this.socket.onerror = (event: ErrorEvent) => {\r\n        this.error = event.error;\r\n        reject(event);\r\n      };\r\n    });\r\n  }\r\n\r\n  private handleError(event: ErrorEvent) {\r\n    this.error = event.error;\r\n    while (this.receiverQueue.length > 0) {\r\n      const [_, reject] = this.receiverQueue.shift()!;\r\n      reject(event.error);\r\n    }\r\n  }\r\n\r\n  private getClosedHandler(\r\n    closeResolve: (_: void) => void,\r\n  ): (_: CloseEvent) => void {\r\n    return (_: CloseEvent) => {\r\n      this.done = true;\r\n      while (this.receiverQueue.length > 0) {\r\n        const [resolve, reject] = this.receiverQueue.shift()!;\r\n        if (this.error) {\r\n          reject(this.error);\r\n        } else {\r\n          resolve({ value: undefined, done: true });\r\n        }\r\n      }\r\n      closeResolve();\r\n    };\r\n  }\r\n\r\n  private getMessageHandler(): (event: MessageEvent) => void {\r\n    const self = this;\r\n    return (event: MessageEvent) => {\r\n      const result = self.validate(event);\r\n      if (isValidatorSuccess(result)) {\r\n        const { message } = result;\r\n        if (self.receiverQueue.length > 0) {\r\n          const [resolve, _] = self.receiverQueue.shift()!;\r\n          resolve({ value: message, done: false });\r\n        } else {\r\n          self.messageQueue.push(message);\r\n        }\r\n      } else {\r\n        self.error = result.error;\r\n        self.socket.close(1000, \"Unexpected message received\");\r\n      }\r\n    };\r\n  }\r\n\r\n  [Symbol.asyncIterator](): AsyncIterator<D> {\r\n    return {\r\n      next: (): Promise<IteratorResult<D>> => {\r\n        if (this.error) {\r\n          return Promise.reject(this.error);\r\n        } else if (this.done) {\r\n          return Promise.resolve({ value: undefined, done: true });\r\n        } else if (this.messageQueue.length > 0) {\r\n          const message = this.messageQueue.shift()!;\r\n          return Promise.resolve({ value: message, done: false });\r\n        } else {\r\n          return new Promise((resolve, reject) => {\r\n            this.receiverQueue.push([resolve, reject]);\r\n          });\r\n        }\r\n      },\r\n    };\r\n  }\r\n\r\n  async send(message: U): Promise<void> {\r\n    await this.connectedPromise;\r\n    if (this.error) {\r\n      throw this.error;\r\n    }\r\n    const serialized = this.serialize(message);\r\n    return sendMessage(this.socket, serialized);\r\n  }\r\n\r\n  async close(): Promise<void> {\r\n    await this.connectedPromise;\r\n    if (this.done) {\r\n      return;\r\n    }\r\n    this.socket.close();\r\n    await this.closedPromise;\r\n  }\r\n}\r\n","// Copyright (c) Microsoft Corporation.\r\n// Licensed under the MIT License.\r\n\r\nexport interface KeyCredential {\r\n  key: string;\r\n}\r\n\r\nexport interface AccessToken {\r\n  token: string;\r\n  expiresOnTimestamp: number;\r\n  refreshAfterTimestamp?: number;\r\n}\r\n\r\nexport interface TokenCredential {\r\n  getToken(scopes: string | string[], options?: unknown): Promise<AccessToken>;\r\n}\r\n\r\nexport function isKeyCredential(\r\n  credential: unknown,\r\n): credential is KeyCredential {\r\n  return (\r\n    typeof credential === \"object\" &&\r\n    credential !== null &&\r\n    \"key\" in credential &&\r\n    typeof (credential as KeyCredential).key === \"string\"\r\n  );\r\n}\r\n\r\nexport function isTokenCredential(\r\n  credential: unknown,\r\n): credential is TokenCredential {\r\n  return (\r\n    typeof credential === \"object\" &&\r\n    credential !== null &&\r\n    \"getToken\" in credential &&\r\n    typeof (credential as TokenCredential).getToken === \"function\"\r\n  );\r\n}\r\n\r\nexport const isCredential = (\r\n  credential: unknown,\r\n): credential is KeyCredential | TokenCredential =>\r\n  isKeyCredential(credential) || isTokenCredential(credential);\r\n","// Copyright (c) Microsoft Corporation.\r\n// Licensed under the MIT License.\r\n\r\nimport { isServerMessageType } from \"./model-utils\";\r\nimport { ServerMessageType, UserMessageType } from \"./models\";\r\nimport {\r\n  ConnectionSettings,\r\n  validationError,\r\n  validationSuccess,\r\n  WebSocketClient,\r\n} from \"./util/websocket-client\";\r\nimport { MessageEvent } from \"./util/websocket\";\r\nimport {\r\n  isCredential,\r\n  isKeyCredential,\r\n  KeyCredential,\r\n  TokenCredential,\r\n} from \"./util/auth\";\r\n\r\nexport interface RTOpenAIOptions {\r\n  model: string;\r\n}\r\n\r\nexport interface RTAzureOpenAIOptions {\r\n  deployment: string;\r\n}\r\n\r\nconst isRTOpenAIOptions = (options: unknown): options is RTOpenAIOptions => {\r\n  return (\r\n    typeof options === \"object\" &&\r\n    options !== null &&\r\n    \"model\" in options &&\r\n    typeof (options as RTOpenAIOptions).model === \"string\"\r\n  );\r\n};\r\n\r\nconst isRTAzureOpenAIOptions = (\r\n  options: unknown,\r\n): options is RTAzureOpenAIOptions => {\r\n  return (\r\n    typeof options === \"object\" &&\r\n    options !== null &&\r\n    \"deployment\" in options &&\r\n    typeof (options as RTAzureOpenAIOptions).deployment === \"string\"\r\n  );\r\n};\r\n\r\nexport class LowLevelRTClient {\r\n  private requestId: string | undefined;\r\n  private client: WebSocketClient<UserMessageType, ServerMessageType>;\r\n\r\n  private azureOpenAISettings(\r\n    uri: URL,\r\n    credential: KeyCredential | TokenCredential,\r\n    options: RTAzureOpenAIOptions,\r\n  ): ConnectionSettings {\r\n    const scopes = [\"https://cognitiveservices.azure.com/.default\"];\r\n    this.requestId = crypto.randomUUID();\r\n    uri.searchParams.set(\"api-version\", \"2024-10-01-preview\");\r\n    uri.searchParams.set(\"x-ms-client-request-id\", this.requestId!);\r\n    uri.searchParams.set(\"deployment\", options.deployment);\r\n    uri.pathname = \"openai/realtime\";\r\n    return {\r\n      uri,\r\n      policy: async (settings) => {\r\n        if (isKeyCredential(credential)) {\r\n          settings.uri.searchParams.set(\"api-key\", credential.key);\r\n        } else {\r\n          const token = await credential.getToken(scopes);\r\n          settings.uri.searchParams.set(\r\n            \"Authorization\",\r\n            `Bearer ${token.token}`,\r\n          );\r\n        }\r\n        return settings;\r\n      },\r\n    };\r\n  }\r\n\r\n  private openAISettings(\r\n    credential: KeyCredential,\r\n    options: RTOpenAIOptions,\r\n  ): ConnectionSettings {\r\n    const uri = new URL(\"wss://api.openai.com/v1/realtime\");\r\n    uri.searchParams.set(\"model\", options.model);\r\n    return {\r\n      uri,\r\n      protocols: [\r\n        \"realtime\",\r\n        `openai-insecure-api-key.${credential.key}`,\r\n        \"openai-beta.realtime-v1\",\r\n      ],\r\n    };\r\n  }\r\n\r\n  private getWebsocket(\r\n    settings: ConnectionSettings,\r\n  ): WebSocketClient<UserMessageType, ServerMessageType> {\r\n    const handler = {\r\n      validate: (event: MessageEvent) => {\r\n        if (typeof event.data !== \"string\") {\r\n          return validationError<ServerMessageType>(\r\n            new Error(\"Invalid message type\"),\r\n          );\r\n        }\r\n        try {\r\n          const data = JSON.parse(event.data as string);\r\n          if (isServerMessageType(data)) {\r\n            return validationSuccess(data);\r\n          }\r\n          return validationError<ServerMessageType>(\r\n            new Error(\"Invalid message type\"),\r\n          );\r\n        } catch (error) {\r\n          return validationError<ServerMessageType>(\r\n            new Error(\"Invalid JSON message\"),\r\n          );\r\n        }\r\n      },\r\n      serialize: (message: UserMessageType) => JSON.stringify(message),\r\n    };\r\n\r\n    return new WebSocketClient<UserMessageType, ServerMessageType>(\r\n      settings,\r\n      handler,\r\n    );\r\n  }\r\n\r\n  constructor(credential: KeyCredential, options: RTOpenAIOptions);\r\n  constructor(\r\n    uri: URL,\r\n    credential: KeyCredential | TokenCredential,\r\n    options: RTAzureOpenAIOptions,\r\n  );\r\n  constructor(\r\n    uriOrCredential: URL | KeyCredential | TokenCredential,\r\n    credentialOrOptions?: KeyCredential | TokenCredential | RTOpenAIOptions,\r\n    options?: RTAzureOpenAIOptions,\r\n  ) {\r\n    const settings = (() => {\r\n      if (\r\n        isKeyCredential(uriOrCredential) &&\r\n        isRTOpenAIOptions(credentialOrOptions)\r\n      ) {\r\n        return this.openAISettings(uriOrCredential, credentialOrOptions);\r\n      } else if (\r\n        isCredential(credentialOrOptions) &&\r\n        isRTAzureOpenAIOptions(options)\r\n      ) {\r\n        return this.azureOpenAISettings(\r\n          uriOrCredential as URL,\r\n          credentialOrOptions,\r\n          options,\r\n        );\r\n      } else {\r\n        throw new Error(\r\n          \"Invalid combination of arguments to initialize the Realtime client\",\r\n        );\r\n      }\r\n    })();\r\n    this.client = this.getWebsocket(settings);\r\n  }\r\n\r\n  async *messages(): AsyncIterable<ServerMessageType> {\r\n    for await (const message of this.client) {\r\n      yield message;\r\n    }\r\n  }\r\n\r\n  async send(message: UserMessageType): Promise<void> {\r\n    await this.client.send(message);\r\n  }\r\n\r\n  async close(): Promise<void> {\r\n    await this.client.close();\r\n  }\r\n}\r\n/*\r\nexport interface RTMessageContentChunk {\r\n  type: MessageContentType;\r\n  data: string;\r\n  index: number;\r\n}\r\n\r\nclass RTMessage implements AsyncIterable<RTMessageContentChunk> {\r\n  private constructor(\r\n    readonly id: string,\r\n    readonly previousId: string | undefined,\r\n    readonly conversationLabel: string,\r\n    readonly content: MessageContent[],\r\n    private readonly receive: () => Promise<ServerMessageType>,\r\n  ) {}\r\n\r\n  async *[Symbol.asyncIterator](): AsyncIterator<RTMessageContentChunk> {\r\n    while (true) {\r\n      const serverMessage = await this.receive();\r\n      if (serverMessage === null) {\r\n        break;\r\n      }\r\n      if (serverMessage.event === \"message_added\") {\r\n        break;\r\n      }\r\n      if (\r\n        serverMessage.event === \"add_content\" &&\r\n        serverMessage.message_id === this.id\r\n      ) {\r\n        // const content = this.content[serverMessage.index];\r\n\r\n        // switch (serverMessage.type) {\r\n        //   case \"text\":\r\n        //     if (content.type !== \"text\") {\r\n        //       throw new Error(\"Unexpected content type\");\r\n        //     }\r\n        //     content.text += serverMessage.data;\r\n        //     break;\r\n        //   case \"audio\":\r\n        //     if (content.type !== \"audio\") {\r\n        //       throw new Error(\"Unexpected content type\");\r\n        //     }\r\n        //     content.audio += serverMessage.data;\r\n        //     break;\r\n        //   case \"tool_call\":\r\n        //     if (content.type !== \"tool_call\") {\r\n        //       throw new Error(\"Unexpected content type\");\r\n        //     }\r\n        //     content.arguments += serverMessage.data;\r\n        //     break;\r\n        //   default:\r\n        //     break;\r\n        // }\r\n        yield {\r\n          type: serverMessage.type,\r\n          data: serverMessage.data,\r\n          index: serverMessage.index,\r\n        };\r\n      }\r\n    }\r\n  }\r\n\r\n  static _create(\r\n    id: string,\r\n    previousId: string | undefined,\r\n    conversationLabel: string,\r\n    content: MessageContent[],\r\n    receive: () => Promise<ServerMessageType>,\r\n  ): RTMessage {\r\n    return new RTMessage(id, previousId, conversationLabel, content, receive);\r\n  }\r\n}\r\n\r\nexport type { RTMessage };\r\n\r\nexport interface RTConversationConfiguration {\r\n  system_message?: string;\r\n  voice?: Voice;\r\n  subscribe_to_user_audio?: boolean;\r\n  output_audio_format?: AudioFormat;\r\n  tools?: unknown;\r\n  tool_choice?: ToolChoice;\r\n  temperature?: number;\r\n  max_tokens?: number;\r\n  disable_audio?: boolean;\r\n}\r\n\r\nclass RTConversation implements AsyncIterable<RTMessage> {\r\n  private allMessagesQueue: MessageQueue<ServerMessageType>;\r\n  private messageQueue: MessageQueue<ServerMessageType>;\r\n\r\n  private constructor(\r\n    readonly label: string,\r\n    private readonly client: LowLevelRTClient,\r\n    receive: () => Promise<ServerMessageType | null>,\r\n  ) {\r\n    this.allMessagesQueue = new MessageQueue<ServerMessageType>(\r\n      receive,\r\n      (message) => {\r\n        switch (message.event) {\r\n          case \"add_message\":\r\n            return \"CONVERSATION-MESSAGE\";\r\n          case \"add_content\":\r\n            return \"MESSAGE\";\r\n          case \"message_added\":\r\n            return \"MESSAGE\";\r\n          case \"generation_finished\":\r\n            return \"CONVERSATION-CONTROL\";\r\n          default:\r\n            break;\r\n        }\r\n        return null;\r\n      },\r\n    );\r\n    this.messageQueue = new MessageQueue<ServerMessageType>(\r\n      async () => {\r\n        return await this.allMessagesQueue.receive(\"MESSAGE\");\r\n      },\r\n      (message) => {\r\n        switch (message.event) {\r\n          case \"add_content\":\r\n            return message.message_id;\r\n          case \"message_added\":\r\n            return message.id;\r\n          default:\r\n            break;\r\n        }\r\n        return null;\r\n      },\r\n    );\r\n  }\r\n\r\n  async configure(config: RTConversationConfiguration): Promise<void> {\r\n    await this.client.send({ event: \"update_conversation_config\", ...config });\r\n  }\r\n\r\n  async *[Symbol.asyncIterator](): AsyncIterator<RTMessage> {\r\n    while (true) {\r\n      const serverMessage = await this.allMessagesQueue.receive(\r\n        \"CONVERSATION-MESSAGE\",\r\n      );\r\n      if (serverMessage === null) {\r\n        break;\r\n      }\r\n      if (serverMessage.event !== \"add_message\") {\r\n        throw new Error(\"Unexpected message type\");\r\n      }\r\n      const message = RTMessage._create(\r\n        serverMessage.message.id,\r\n        serverMessage.previous_id,\r\n        serverMessage.conversation_label,\r\n        serverMessage.message.content,\r\n        async () => {\r\n          return await this.messageQueue.receive(serverMessage.message.id);\r\n        },\r\n      );\r\n      yield message;\r\n    }\r\n  }\r\n\r\n  async *controlMessages(): AsyncIterable<ServerGenerationFinishedMessage> {\r\n    while (true) {\r\n      const message = await this.allMessagesQueue.receive(\r\n        \"CONVERSATION-CONTROL\",\r\n      );\r\n      if (message === null) {\r\n        break;\r\n      }\r\n      if (message.event !== \"generation_finished\") {\r\n        throw new Error(\"Unexpected message type\");\r\n      }\r\n      yield message;\r\n    }\r\n  }\r\n\r\n  static _create(\r\n    label: string,\r\n    client: LowLevelRTClient,\r\n    receive: () => Promise<ServerMessageType | null>,\r\n  ) {\r\n    return new RTConversation(label, client, receive);\r\n  }\r\n}\r\n\r\nexport type { RTConversation };\r\n\r\nexport interface RTSessionConfiguration {\r\n  turn_detection?: TurnDetection;\r\n  input_audio_format?: AudioFormat;\r\n  transcribe_input?: boolean;\r\n  vad?: VADConfiguration;\r\n}\r\n\r\nexport class RTClient {\r\n  private client: LowLevelRTClient;\r\n  private messageQueue: MessageQueue<ServerMessageType>;\r\n  private conversationQueue: MessageQueue<ServerMessageType>;\r\n  private conversationMap: Map<string, string> = new Map();\r\n\r\n  constructor(key: string);\r\n  constructor(uri: URL, key: string);\r\n  constructor(uriOrKey: string | URL, key?: string) {\r\n    this.client =\r\n      key === undefined\r\n        ? new LowLevelRTClient(uriOrKey as string)\r\n        : new LowLevelRTClient(uriOrKey as URL, key);\r\n    this.messageQueue = new MessageQueue<ServerMessageType>(\r\n      async () => {\r\n        for await (const message of this.client.messages()) {\r\n          return message;\r\n        }\r\n        return null;\r\n      },\r\n      (message) => {\r\n        switch (message.event) {\r\n          case \"start_session\":\r\n          case \"error\":\r\n          case \"vad_speech_started\":\r\n          case \"vad_speech_stopped\":\r\n          case \"input_transcribed\":\r\n          case \"generation_canceled\":\r\n          case \"send_state\":\r\n            return \"SESSION\";\r\n          case \"add_message\":\r\n          case \"add_content\":\r\n          case \"message_added\":\r\n          case \"generation_finished\":\r\n            return \"CONVERSATION\";\r\n          default:\r\n            break;\r\n        }\r\n        return null;\r\n      },\r\n    );\r\n    this.conversationQueue = new MessageQueue<ServerMessageType>(\r\n      async () => {\r\n        return await this.messageQueue.receive(\"CONVERSATION\");\r\n      },\r\n      (message) => {\r\n        switch (message.event) {\r\n          case \"add_message\":\r\n            this.conversationMap.set(\r\n              message.message.id,\r\n              message.conversation_label,\r\n            );\r\n            return message.conversation_label;\r\n          case \"add_content\":\r\n            return this.conversationMap.get(message.message_id) ?? null;\r\n          case \"message_added\":\r\n            this.conversationMap.delete(message.id);\r\n            return message.conversation_label;\r\n          case \"generation_finished\":\r\n            return message.conversation_label;\r\n          default:\r\n            break;\r\n        }\r\n        return null;\r\n      },\r\n    );\r\n  }\r\n\r\n  async configure(config: RTSessionConfiguration): Promise<void> {\r\n    await this.client.send({ event: \"update_session_config\", ...config });\r\n  }\r\n\r\n  getDefaultConversation(): RTConversation {\r\n    return RTConversation._create(\"default\", this.client, async () => {\r\n      return this.conversationQueue.receive(\"default\");\r\n    });\r\n  }\r\n\r\n  async createConversation(label: string): Promise<RTConversation> {\r\n    if (label === \"default\") {\r\n      throw new Error(\"Cannot create conversation with label 'default'\");\r\n    }\r\n    await this.client.send({ event: \"create_conversation\", label });\r\n    return RTConversation._create(label, this.client, async () => {\r\n      return this.conversationQueue.receive(label);\r\n    });\r\n  }\r\n\r\n  async deleteConversation(label: string): Promise<void> {\r\n    if (label === \"default\") {\r\n      throw new Error(\"Cannot delete conversation with label 'default'\");\r\n    }\r\n    await this.client.send({ event: \"delete_conversation\", label });\r\n  }\r\n\r\n  async sendAudio(audio: ArrayBuffer): Promise<void> {\r\n    const base64Encoded = Buffer.from(audio).toString(\"base64\");\r\n    await this.client.send({ event: \"add_user_audio\", data: base64Encoded });\r\n  }\r\n\r\n  async *controlMessages(): AsyncIterable<ServerMessageType> {\r\n    while (true) {\r\n      const message = await this.messageQueue.receive(\"SESSION\");\r\n      if (message === null) {\r\n        break;\r\n      }\r\n      yield message;\r\n    }\r\n  }\r\n\r\n  async close(): Promise<void> {\r\n    await this.client.close();\r\n  }\r\n}\r\n*/\r\n"],"names":["WebSocket"],"mappings":";;;IAAA;IACA;AAuEO,QAAM,eAAe,GAAG;;ICxE/B;IACA;AACA;IACA;IACA;AACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;AACA;AAkGA;IACO,SAAS,SAAS,CAAC,OAAO,EAAE,UAAU,EAAE,CAAC,EAAE,SAAS,EAAE;IAC7D,IAAI,SAAS,KAAK,CAAC,KAAK,EAAE,EAAE,OAAO,KAAK,YAAY,CAAC,GAAG,KAAK,GAAG,IAAI,CAAC,CAAC,UAAU,OAAO,EAAE,EAAE,OAAO,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE;IAChH,IAAI,OAAO,KAAK,CAAC,KAAK,CAAC,GAAG,OAAO,CAAC,EAAE,UAAU,OAAO,EAAE,MAAM,EAAE;IAC/D,QAAQ,SAAS,SAAS,CAAC,KAAK,EAAE,EAAE,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,CAAC,OAAO,CAAC,EAAE,EAAE,MAAM,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE;IACnG,QAAQ,SAAS,QAAQ,CAAC,KAAK,EAAE,EAAE,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,CAAC,OAAO,CAAC,EAAE,EAAE,MAAM,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE;IACtG,QAAQ,SAAS,IAAI,CAAC,MAAM,EAAE,EAAE,MAAM,CAAC,IAAI,GAAG,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,GAAG,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,SAAS,EAAE,QAAQ,CAAC,CAAC,EAAE;IACtH,QAAQ,IAAI,CAAC,CAAC,SAAS,GAAG,SAAS,CAAC,KAAK,CAAC,OAAO,EAAE,UAAU,IAAI,EAAE,CAAC,EAAE,IAAI,EAAE,CAAC,CAAC;IAC9E,KAAK,CAAC,CAAC;IACP,CAAC;AACD;IACO,SAAS,WAAW,CAAC,OAAO,EAAE,IAAI,EAAE;IAC3C,IAAI,IAAI,CAAC,GAAG,EAAE,KAAK,EAAE,CAAC,EAAE,IAAI,EAAE,WAAW,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,IAAI,EAAE,EAAE,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,MAAM,CAAC,CAAC,OAAO,QAAQ,KAAK,UAAU,GAAG,QAAQ,GAAG,MAAM,EAAE,SAAS,CAAC,CAAC;IACrM,IAAI,OAAO,CAAC,CAAC,IAAI,GAAG,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,OAAO,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,QAAQ,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,EAAE,OAAO,MAAM,KAAK,UAAU,KAAK,CAAC,CAAC,MAAM,CAAC,QAAQ,CAAC,GAAG,WAAW,EAAE,OAAO,IAAI,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IAChK,IAAI,SAAS,IAAI,CAAC,CAAC,EAAE,EAAE,OAAO,UAAU,CAAC,EAAE,EAAE,OAAO,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE;IACtE,IAAI,SAAS,IAAI,CAAC,EAAE,EAAE;IACtB,QAAQ,IAAI,CAAC,EAAE,MAAM,IAAI,SAAS,CAAC,iCAAiC,CAAC,CAAC;IACtE,QAAQ,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,IAAI;IACtD,YAAY,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,KAAK,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,QAAQ,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,GAAG,CAAC,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC,EAAE,IAAI,EAAE,OAAO,CAAC,CAAC;IACzK,YAAY,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE,GAAG,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC;IACpD,YAAY,QAAQ,EAAE,CAAC,CAAC,CAAC;IACzB,gBAAgB,KAAK,CAAC,CAAC,CAAC,KAAK,CAAC,EAAE,CAAC,GAAG,EAAE,CAAC,CAAC,MAAM;IAC9C,gBAAgB,KAAK,CAAC,EAAE,CAAC,CAAC,KAAK,EAAE,CAAC,CAAC,OAAO,EAAE,KAAK,EAAE,EAAE,CAAC,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,CAAC;IACxE,gBAAgB,KAAK,CAAC,EAAE,CAAC,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,SAAS;IACjE,gBAAgB,KAAK,CAAC,EAAE,EAAE,GAAG,CAAC,CAAC,GAAG,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC,CAAC,SAAS;IACjE,gBAAgB;IAChB,oBAAoB,IAAI,EAAE,CAAC,GAAG,CAAC,CAAC,IAAI,EAAE,CAAC,GAAG,CAAC,CAAC,MAAM,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,EAAE,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC,SAAS,EAAE;IAChI,oBAAoB,IAAI,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,KAAK,GAAG,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,MAAM,EAAE;IAC1G,oBAAoB,IAAI,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC,MAAM,EAAE;IACzF,oBAAoB,IAAI,CAAC,IAAI,CAAC,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,MAAM,EAAE;IACvF,oBAAoB,IAAI,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,GAAG,CAAC,GAAG,EAAE,CAAC;IAC1C,oBAAoB,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC,CAAC,SAAS;IAC3C,aAAa;IACb,YAAY,EAAE,GAAG,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC,CAAC,CAAC;IACvC,SAAS,CAAC,OAAO,CAAC,EAAE,EAAE,EAAE,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE,SAAS,EAAE,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,EAAE;IAClE,QAAQ,IAAI,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,MAAM,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,OAAO,EAAE,KAAK,EAAE,EAAE,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC;IACzF,KAAK;IACL,CAAC;AAiBD;IACO,SAAS,QAAQ,CAAC,CAAC,EAAE;IAC5B,IAAI,IAAI,CAAC,GAAG,OAAO,MAAM,KAAK,UAAU,IAAI,MAAM,CAAC,QAAQ,EAAE,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC;IAClF,IAAI,IAAI,CAAC,EAAE,OAAO,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;IAC5B,IAAI,IAAI,CAAC,IAAI,OAAO,CAAC,CAAC,MAAM,KAAK,QAAQ,EAAE,OAAO;IAClD,QAAQ,IAAI,EAAE,YAAY;IAC1B,YAAY,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,MAAM,EAAE,CAAC,GAAG,KAAK,CAAC,CAAC;IAC/C,YAAY,OAAO,EAAE,KAAK,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,IAAI,EAAE,CAAC,CAAC,EAAE,CAAC;IACpD,SAAS;IACT,KAAK,CAAC;IACN,IAAI,MAAM,IAAI,SAAS,CAAC,CAAC,GAAG,yBAAyB,GAAG,iCAAiC,CAAC,CAAC;IAC3F,CAAC;AACD;IACO,SAAS,MAAM,CAAC,CAAC,EAAE,CAAC,EAAE;IAC7B,IAAI,IAAI,CAAC,GAAG,OAAO,MAAM,KAAK,UAAU,IAAI,CAAC,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;IAC/D,IAAI,IAAI,CAAC,CAAC,EAAE,OAAO,CAAC,CAAC;IACrB,IAAI,IAAI,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,GAAG,EAAE,EAAE,CAAC,CAAC;IACrC,IAAI,IAAI;IACR,QAAQ,OAAO,CAAC,CAAC,KAAK,KAAK,CAAC,IAAI,CAAC,EAAE,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,IAAI,EAAE,EAAE,IAAI,EAAE,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC;IACnF,KAAK;IACL,IAAI,OAAO,KAAK,EAAE,EAAE,CAAC,GAAG,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,EAAE;IAC3C,YAAY;IACZ,QAAQ,IAAI;IACZ,YAAY,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,KAAK,CAAC,GAAG,CAAC,CAAC,QAAQ,CAAC,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;IAC7D,SAAS;IACT,gBAAgB,EAAE,IAAI,CAAC,EAAE,MAAM,CAAC,CAAC,KAAK,CAAC,EAAE;IACzC,KAAK;IACL,IAAI,OAAO,EAAE,CAAC;IACd,CAAC;AA2BD;IACO,SAAS,OAAO,CAAC,CAAC,EAAE;IAC3B,IAAI,OAAO,IAAI,YAAY,OAAO,IAAI,IAAI,CAAC,CAAC,GAAG,CAAC,EAAE,IAAI,IAAI,IAAI,OAAO,CAAC,CAAC,CAAC,CAAC;IACzE,CAAC;AACD;IACO,SAAS,gBAAgB,CAAC,OAAO,EAAE,UAAU,EAAE,SAAS,EAAE;IACjE,IAAI,IAAI,CAAC,MAAM,CAAC,aAAa,EAAE,MAAM,IAAI,SAAS,CAAC,sCAAsC,CAAC,CAAC;IAC3F,IAAI,IAAI,CAAC,GAAG,SAAS,CAAC,KAAK,CAAC,OAAO,EAAE,UAAU,IAAI,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,GAAG,EAAE,CAAC;IAClE,IAAI,OAAO,CAAC,GAAG,MAAM,CAAC,MAAM,CAAC,CAAC,OAAO,aAAa,KAAK,UAAU,GAAG,aAAa,GAAG,MAAM,EAAE,SAAS,CAAC,EAAE,IAAI,CAAC,MAAM,CAAC,EAAE,IAAI,CAAC,OAAO,CAAC,EAAE,IAAI,CAAC,QAAQ,EAAE,WAAW,CAAC,EAAE,CAAC,CAAC,MAAM,CAAC,aAAa,CAAC,GAAG,YAAY,EAAE,OAAO,IAAI,CAAC,EAAE,EAAE,CAAC,CAAC;IAC5N,IAAI,SAAS,WAAW,CAAC,CAAC,EAAE,EAAE,OAAO,UAAU,CAAC,EAAE,EAAE,OAAO,OAAO,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,EAAE,MAAM,CAAC,CAAC,EAAE,CAAC,EAAE;IACnG,IAAI,SAAS,IAAI,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC,GAAG,UAAU,CAAC,EAAE,EAAE,OAAO,IAAI,OAAO,CAAC,UAAU,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE;IAC5K,IAAI,SAAS,MAAM,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,OAAO,CAAC,EAAE,EAAE,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,EAAE;IACtF,IAAI,SAAS,IAAI,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,KAAK,YAAY,OAAO,GAAG,OAAO,CAAC,OAAO,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,OAAO,EAAE,MAAM,CAAC,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE;IAC5H,IAAI,SAAS,OAAO,CAAC,KAAK,EAAE,EAAE,MAAM,CAAC,MAAM,EAAE,KAAK,CAAC,CAAC,EAAE;IACtD,IAAI,SAAS,MAAM,CAAC,KAAK,EAAE,EAAE,MAAM,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC,EAAE;IACtD,IAAI,SAAS,MAAM,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;IACtF,CAAC;AAOD;IACO,SAAS,aAAa,CAAC,CAAC,EAAE;IACjC,IAAI,IAAI,CAAC,MAAM,CAAC,aAAa,EAAE,MAAM,IAAI,SAAS,CAAC,sCAAsC,CAAC,CAAC;IAC3F,IAAI,IAAI,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,aAAa,CAAC,EAAE,CAAC,CAAC;IACvC,IAAI,OAAO,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,OAAO,QAAQ,KAAK,UAAU,GAAG,QAAQ,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,QAAQ,CAAC,EAAE,EAAE,CAAC,GAAG,EAAE,EAAE,IAAI,CAAC,MAAM,CAAC,EAAE,IAAI,CAAC,OAAO,CAAC,EAAE,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC,MAAM,CAAC,aAAa,CAAC,GAAG,YAAY,EAAE,OAAO,IAAI,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC;IACrN,IAAI,SAAS,IAAI,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,IAAI,UAAU,CAAC,EAAE,EAAE,OAAO,IAAI,OAAO,CAAC,UAAU,OAAO,EAAE,MAAM,EAAE,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,MAAM,CAAC,OAAO,EAAE,MAAM,EAAE,CAAC,CAAC,IAAI,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE;IACpK,IAAI,SAAS,MAAM,CAAC,OAAO,EAAE,MAAM,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,OAAO,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,EAAE,OAAO,CAAC,EAAE,KAAK,EAAE,CAAC,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,EAAE,MAAM,CAAC,CAAC,EAAE;IAChI,CAAC;AAkED;IACuB,OAAO,eAAe,KAAK,UAAU,GAAG,eAAe,GAAG,UAAU,KAAK,EAAE,UAAU,EAAE,OAAO,EAAE;IACvH,IAAI,IAAI,CAAC,GAAG,IAAI,KAAK,CAAC,OAAO,CAAC,CAAC;IAC/B,IAAI,OAAO,CAAC,CAAC,IAAI,GAAG,iBAAiB,EAAE,CAAC,CAAC,KAAK,GAAG,KAAK,EAAE,CAAC,CAAC,UAAU,GAAG,UAAU,EAAE,CAAC,CAAC;IACrF;;IChUA,IAAM,eAAe,GAAG,UAAC,OAAgB,EAAA;QACvC,OAAA,OAAO,OAAO,KAAK,QAAQ,IAAI,OAAO,KAAK,IAAI,IAAI,MAAM,IAAI,OAAO,CAAA;IAApE,CAAoE,CAAC;IAEhE,IAAM,mBAAmB,GAAG,UACjC,OAAgB,EAAA;QAEhB,OAAA,eAAe,CAAC,OAAO,CAAC;IACxB,QAAA;gBACE,OAAO;gBACP,iBAAiB;gBACjB,iBAAiB;gBACjB,8BAA8B;gBAC9B,4BAA4B;gBAC5B,mCAAmC;gBACnC,mCAAmC;gBACnC,2BAA2B;gBAC3B,6BAA6B;gBAC7B,2BAA2B;gBAC3B,uDAAuD;gBACvD,oDAAoD;gBACpD,kBAAkB;gBAClB,eAAe;gBACf,4BAA4B;gBAC5B,2BAA2B;gBAC3B,6BAA6B;gBAC7B,4BAA4B;gBAC5B,qBAAqB;gBACrB,oBAAoB;gBACpB,iCAAiC;gBACjC,gCAAgC;gBAChC,sBAAsB;gBACtB,qBAAqB;gBACrB,wCAAwC;gBACxC,uCAAuC;gBACvC,qBAAqB;IACtB,SAAA,CAAC,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,CAAA;IA7BxB,CA6BwB;;ICrC1B;IACA;IAGA,IAAM,GAAG,GAAG,SAAS,CAAC;IAWf,IAAM,WAAW,GAAG,UACzB,MAAiB,EACjB,OAAmD,EAAA;QAEnD,IAAI,MAAM,CAAC,UAAU,KAAK,SAAS,CAAC,IAAI,EAAE;YACxC,OAAO,OAAO,CAAC,MAAM,CAAC,IAAI,KAAK,CAAC,oBAAoB,CAAC,CAAC,CAAC;SACxD;IACD,IAAA,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;IACrB,IAAA,OAAO,OAAO,CAAC,OAAO,EAAE,CAAC;IAC3B,CAAC;;ICxBD;IACA;IAiBO,IAAM,iBAAiB,GAAG,UAAI,OAAU,EAAA,EAAyB,QAAC;IACvE,IAAA,OAAO,EAAE,IAAI;IACb,IAAA,OAAO,EAAA,OAAA;KACR,EAAC,EAAA,CAAC;IACI,IAAM,eAAe,GAAG,UAAI,KAAY,EAAA,EAAyB,QAAC;IACvE,IAAA,OAAO,EAAE,KAAK;IACd,IAAA,KAAK,EAAA,KAAA;KACN,EAAC,EAAA,CAAC;IACH,IAAM,kBAAkB,GAAG,UACzB,MAA0B,EAAA,EACkB,OAAA,MAAM,CAAC,OAAO,CAAd,EAAc,CAAC;IAwB7D,IAAA,eAAA,kBAAA,YAAA;QAYE,SACE,eAAA,CAAA,QAA4B,EAC5B,OAAqC,EAAA;YAFvC,IAyBC,KAAA,GAAA,IAAA,CAAA;YAlCO,IAAa,CAAA,aAAA,GAA8B,SAAS,CAAC;YAErD,IAAY,CAAA,YAAA,GAAQ,EAAE,CAAC;YAIvB,IAAa,CAAA,aAAA,GAAsC,EAAE,CAAC;YACtD,IAAI,CAAA,IAAA,GAAY,KAAK,CAAC;IAM5B,QAAA,IAAI,CAAC,QAAQ,GAAG,OAAO,CAAC,QAAQ,CAAC;IACjC,QAAA,IAAI,CAAC,SAAS,GAAG,OAAO,CAAC,SAAS,CAAC;YACnC,IAAI,CAAC,gBAAgB,GAAG,IAAI,OAAO,CAAC,UAAO,OAAO,EAAE,MAAM,EAAA,EAAA,OAAA,SAAA,CAAA,KAAA,EAAA,KAAA,CAAA,EAAA,KAAA,CAAA,EAAA,YAAA;;;;;;IAEtD,wBAAA,IAAA,EAAA,QAAQ,CAAC,MAAM,KAAK,SAAS,CAAA,EAA7B,OAA6B,CAAA,CAAA,YAAA,CAAA,CAAA,CAAA;IACzB,wBAAA,EAAA,GAAA,QAAQ,CAAA;;IACR,oBAAA,KAAA,CAAA,EAAA,OAAA,CAAA,CAAA,YAAM,QAAQ,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAA,CAAA;;IAA/B,wBAAA,EAAA,GAAA,SAA+B,CAAA;;;IAH/B,wBAAA,EAAA,GAAA,EAG+B,EAH7B,GAAG,GAAA,EAAA,CAAA,GAAA,EAAE,SAAS,GAAA,EAAA,CAAA,SAAA,CAAA;IAItB,wBAAA,IAAI,CAAC,MAAM,GAAG,IAAIA,GAAS,CAAC,GAAG,CAAC,QAAQ,EAAE,EAAE,SAAS,CAAC,CAAC;IACvD,wBAAA,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,YAAA;gCACnB,KAAI,CAAC,MAAM,CAAC,SAAS,GAAG,KAAI,CAAC,iBAAiB,EAAE,CAAC;IACjD,4BAAA,KAAI,CAAC,aAAa,GAAG,IAAI,OAAO,CAAC,UAAC,OAAO,EAAA;oCACvC,KAAI,CAAC,MAAM,CAAC,OAAO,GAAG,KAAI,CAAC,gBAAgB,CAAC,OAAO,CAAC,CAAC;IACvD,6BAAC,CAAC,CAAC;gCACH,KAAI,CAAC,MAAM,CAAC,OAAO,GAAG,KAAI,CAAC,WAAW,CAAC;IACvC,4BAAA,OAAO,EAAE,CAAC;IACZ,yBAAC,CAAC;IACF,wBAAA,IAAI,CAAC,MAAM,CAAC,OAAO,GAAG,UAAC,KAAiB,EAAA;IACtC,4BAAA,KAAI,CAAC,KAAK,GAAG,KAAK,CAAC,KAAK,CAAC;gCACzB,MAAM,CAAC,KAAK,CAAC,CAAC;IAChB,yBAAC,CAAC;;;;IACH,SAAA,CAAA,CAAA,EAAA,CAAC,CAAC;SACJ;QAEO,eAAW,CAAA,SAAA,CAAA,WAAA,GAAnB,UAAoB,KAAiB,EAAA;IACnC,QAAA,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC,KAAK,CAAC;YACzB,OAAO,IAAI,CAAC,aAAa,CAAC,MAAM,GAAG,CAAC,EAAE;IAC9B,YAAA,IAAA,EAAA,GAAA,MAAA,CAAc,IAAI,CAAC,aAAa,CAAC,KAAK,EAAG,EAAA,CAAA,CAAA,EAAvC,EAAA,CAAA,CAAA,CAAA,CAAE,KAAA,MAAM,SAAgC;IAChD,YAAA,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;aACrB;SACF,CAAA;QAEO,eAAgB,CAAA,SAAA,CAAA,gBAAA,GAAxB,UACE,YAA+B,EAAA;YADjC,IAeC,KAAA,GAAA,IAAA,CAAA;IAZC,QAAA,OAAO,UAAC,CAAa,EAAA;IACnB,YAAA,KAAI,CAAC,IAAI,GAAG,IAAI,CAAC;gBACjB,OAAO,KAAI,CAAC,aAAa,CAAC,MAAM,GAAG,CAAC,EAAE;IAC9B,gBAAA,IAAA,EAAA,GAAA,MAAA,CAAoB,KAAI,CAAC,aAAa,CAAC,KAAK,EAAG,EAAA,CAAA,CAAA,EAA9C,OAAO,GAAA,EAAA,CAAA,CAAA,CAAA,EAAE,MAAM,QAA+B,CAAC;IACtD,gBAAA,IAAI,KAAI,CAAC,KAAK,EAAE;IACd,oBAAA,MAAM,CAAC,KAAI,CAAC,KAAK,CAAC,CAAC;qBACpB;yBAAM;wBACL,OAAO,CAAC,EAAE,KAAK,EAAE,SAAS,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC,CAAC;qBAC3C;iBACF;IACD,YAAA,YAAY,EAAE,CAAC;IACjB,SAAC,CAAC;SACH,CAAA;IAEO,IAAA,eAAA,CAAA,SAAA,CAAA,iBAAiB,GAAzB,YAAA;YACE,IAAM,IAAI,GAAG,IAAI,CAAC;IAClB,QAAA,OAAO,UAAC,KAAmB,EAAA;gBACzB,IAAM,MAAM,GAAG,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;IACpC,YAAA,IAAI,kBAAkB,CAAC,MAAM,CAAC,EAAE;IACtB,gBAAA,IAAA,OAAO,GAAK,MAAM,CAAA,OAAX,CAAY;oBAC3B,IAAI,IAAI,CAAC,aAAa,CAAC,MAAM,GAAG,CAAC,EAAE;IAC3B,oBAAA,IAAA,EAAA,GAAA,MAAA,CAAe,IAAI,CAAC,aAAa,CAAC,KAAK,EAAG,EAAA,CAAA,CAAA,EAAzC,OAAO,GAAA,EAAA,CAAA,CAAA,CAAA,CAAE,OAAiC;wBACjD,OAAO,CAAC,EAAE,KAAK,EAAE,OAAO,EAAE,IAAI,EAAE,KAAK,EAAE,CAAC,CAAC;qBAC1C;yBAAM;IACL,oBAAA,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;qBACjC;iBACF;qBAAM;IACL,gBAAA,IAAI,CAAC,KAAK,GAAG,MAAM,CAAC,KAAK,CAAC;oBAC1B,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,EAAE,6BAA6B,CAAC,CAAC;iBACxD;IACH,SAAC,CAAC;SACH,CAAA;IAED,IAAA,eAAA,CAAA,SAAA,CAAC,MAAM,CAAC,aAAa,CAAC,GAAtB,YAAA;YAAA,IAiBC,KAAA,GAAA,IAAA,CAAA;YAhBC,OAAO;IACL,YAAA,IAAI,EAAE,YAAA;IACJ,gBAAA,IAAI,KAAI,CAAC,KAAK,EAAE;wBACd,OAAO,OAAO,CAAC,MAAM,CAAC,KAAI,CAAC,KAAK,CAAC,CAAC;qBACnC;IAAM,qBAAA,IAAI,KAAI,CAAC,IAAI,EAAE;IACpB,oBAAA,OAAO,OAAO,CAAC,OAAO,CAAC,EAAE,KAAK,EAAE,SAAS,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC,CAAC;qBAC1D;yBAAM,IAAI,KAAI,CAAC,YAAY,CAAC,MAAM,GAAG,CAAC,EAAE;wBACvC,IAAM,OAAO,GAAG,KAAI,CAAC,YAAY,CAAC,KAAK,EAAG,CAAC;IAC3C,oBAAA,OAAO,OAAO,CAAC,OAAO,CAAC,EAAE,KAAK,EAAE,OAAO,EAAE,IAAI,EAAE,KAAK,EAAE,CAAC,CAAC;qBACzD;yBAAM;IACL,oBAAA,OAAO,IAAI,OAAO,CAAC,UAAC,OAAO,EAAE,MAAM,EAAA;4BACjC,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC,CAAC;IAC7C,qBAAC,CAAC,CAAC;qBACJ;iBACF;aACF,CAAC;SACH,CAAA;QAEK,eAAI,CAAA,SAAA,CAAA,IAAA,GAAV,UAAW,OAAU,EAAA;;;;;gCACnB,OAAM,CAAA,CAAA,YAAA,IAAI,CAAC,gBAAgB,CAAA,CAAA;;IAA3B,wBAAA,EAAA,CAAA,IAAA,EAA2B,CAAC;IAC5B,wBAAA,IAAI,IAAI,CAAC,KAAK,EAAE;gCACd,MAAM,IAAI,CAAC,KAAK,CAAC;6BAClB;IACK,wBAAA,UAAU,GAAG,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;4BAC3C,OAAO,CAAA,CAAA,aAAA,WAAW,CAAC,IAAI,CAAC,MAAM,EAAE,UAAU,CAAC,CAAC,CAAA;;;;IAC7C,KAAA,CAAA;IAEK,IAAA,eAAA,CAAA,SAAA,CAAA,KAAK,GAAX,YAAA;;;;gCACE,OAAM,CAAA,CAAA,YAAA,IAAI,CAAC,gBAAgB,CAAA,CAAA;;IAA3B,wBAAA,EAAA,CAAA,IAAA,EAA2B,CAAC;IAC5B,wBAAA,IAAI,IAAI,CAAC,IAAI,EAAE;gCACb,OAAO,CAAA,CAAA,YAAA,CAAA;6BACR;IACD,wBAAA,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC;4BACpB,OAAM,CAAA,CAAA,YAAA,IAAI,CAAC,aAAa,CAAA,CAAA;;IAAxB,wBAAA,EAAA,CAAA,IAAA,EAAwB,CAAC;;;;;IAC1B,KAAA,CAAA;QACH,OAAC,eAAA,CAAA;IAAD,CAAC,EAAA,CAAA;;IC3KD;IACA;IAgBM,SAAU,eAAe,CAC7B,UAAmB,EAAA;IAEnB,IAAA,QACE,OAAO,UAAU,KAAK,QAAQ;IAC9B,QAAA,UAAU,KAAK,IAAI;IACnB,QAAA,KAAK,IAAI,UAAU;IACnB,QAAA,OAAQ,UAA4B,CAAC,GAAG,KAAK,QAAQ,EACrD;IACJ,CAAC;IAEK,SAAU,iBAAiB,CAC/B,UAAmB,EAAA;IAEnB,IAAA,QACE,OAAO,UAAU,KAAK,QAAQ;IAC9B,QAAA,UAAU,KAAK,IAAI;IACnB,QAAA,UAAU,IAAI,UAAU;IACxB,QAAA,OAAQ,UAA8B,CAAC,QAAQ,KAAK,UAAU,EAC9D;IACJ,CAAC;IAEM,IAAM,YAAY,GAAG,UAC1B,UAAmB,EAAA;QAEnB,OAAA,eAAe,CAAC,UAAU,CAAC,IAAI,iBAAiB,CAAC,UAAU,CAAC,CAAA;IAA5D,CAA4D;;IC1C9D;IACA;IA0BA,IAAM,iBAAiB,GAAG,UAAC,OAAgB,EAAA;IACzC,IAAA,QACE,OAAO,OAAO,KAAK,QAAQ;IAC3B,QAAA,OAAO,KAAK,IAAI;IAChB,QAAA,OAAO,IAAI,OAAO;IAClB,QAAA,OAAQ,OAA2B,CAAC,KAAK,KAAK,QAAQ,EACtD;IACJ,CAAC,CAAC;IAEF,IAAM,sBAAsB,GAAG,UAC7B,OAAgB,EAAA;IAEhB,IAAA,QACE,OAAO,OAAO,KAAK,QAAQ;IAC3B,QAAA,OAAO,KAAK,IAAI;IAChB,QAAA,YAAY,IAAI,OAAO;IACvB,QAAA,OAAQ,OAAgC,CAAC,UAAU,KAAK,QAAQ,EAChE;IACJ,CAAC,CAAC;AAEF,QAAA,gBAAA,kBAAA,YAAA;IAuFE,IAAA,SAAA,gBAAA,CACE,eAAsD,EACtD,mBAAuE,EACvE,OAA8B,EAAA;YAHhC,IA2BC,KAAA,GAAA,IAAA,CAAA;YAtBC,IAAM,QAAQ,GAAG,CAAC,YAAA;gBAChB,IACE,eAAe,CAAC,eAAe,CAAC;IAChC,gBAAA,iBAAiB,CAAC,mBAAmB,CAAC,EACtC;oBACA,OAAO,KAAI,CAAC,cAAc,CAAC,eAAe,EAAE,mBAAmB,CAAC,CAAC;iBAClE;qBAAM,IACL,YAAY,CAAC,mBAAmB,CAAC;IACjC,gBAAA,sBAAsB,CAAC,OAAO,CAAC,EAC/B;oBACA,OAAO,KAAI,CAAC,mBAAmB,CAC7B,eAAsB,EACtB,mBAAmB,EACnB,OAAO,CACR,CAAC;iBACH;qBAAM;IACL,gBAAA,MAAM,IAAI,KAAK,CACb,oEAAoE,CACrE,CAAC;iBACH;aACF,GAAG,CAAC;YACL,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC;SAC3C;IA9GO,IAAA,gBAAA,CAAA,SAAA,CAAA,mBAAmB,GAA3B,UACE,GAAQ,EACR,UAA2C,EAC3C,OAA6B,EAAA;YAH/B,IA0BC,KAAA,GAAA,IAAA,CAAA;IArBC,QAAA,IAAM,MAAM,GAAG,CAAC,8CAA8C,CAAC,CAAC;IAChE,QAAA,IAAI,CAAC,SAAS,GAAG,MAAM,CAAC,UAAU,EAAE,CAAC;YACrC,GAAG,CAAC,YAAY,CAAC,GAAG,CAAC,aAAa,EAAE,oBAAoB,CAAC,CAAC;YAC1D,GAAG,CAAC,YAAY,CAAC,GAAG,CAAC,wBAAwB,EAAE,IAAI,CAAC,SAAU,CAAC,CAAC;YAChE,GAAG,CAAC,YAAY,CAAC,GAAG,CAAC,YAAY,EAAE,OAAO,CAAC,UAAU,CAAC,CAAC;IACvD,QAAA,GAAG,CAAC,QAAQ,GAAG,iBAAiB,CAAC;YACjC,OAAO;IACL,YAAA,GAAG,EAAA,GAAA;gBACH,MAAM,EAAE,UAAO,QAAQ,EAAA,EAAA,OAAA,SAAA,CAAA,KAAA,EAAA,KAAA,CAAA,EAAA,KAAA,CAAA,EAAA,YAAA;;;;;IACjB,4BAAA,IAAA,CAAA,eAAe,CAAC,UAAU,CAAC,EAA3B,OAA2B,CAAA,CAAA,YAAA,CAAA,CAAA,CAAA;IAC7B,4BAAA,QAAQ,CAAC,GAAG,CAAC,YAAY,CAAC,GAAG,CAAC,SAAS,EAAE,UAAU,CAAC,GAAG,CAAC,CAAC;;IAE3C,wBAAA,KAAA,CAAA,EAAA,OAAA,CAAA,CAAA,YAAM,UAAU,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAA,CAAA;;IAAzC,4BAAA,KAAK,GAAG,EAAiC,CAAA,IAAA,EAAA,CAAA;IAC/C,4BAAA,QAAQ,CAAC,GAAG,CAAC,YAAY,CAAC,GAAG,CAC3B,eAAe,EACf,iBAAU,KAAK,CAAC,KAAK,CAAE,CACxB,CAAC;;IAEJ,wBAAA,KAAA,CAAA,EAAA,OAAA,CAAA,CAAA,aAAO,QAAQ,CAAC,CAAA;;;IACjB,aAAA,CAAA,CAAA,EAAA;aACF,CAAC;SACH,CAAA;IAEO,IAAA,gBAAA,CAAA,SAAA,CAAA,cAAc,GAAtB,UACE,UAAyB,EACzB,OAAwB,EAAA;IAExB,QAAA,IAAM,GAAG,GAAG,IAAI,GAAG,CAAC,kCAAkC,CAAC,CAAC;YACxD,GAAG,CAAC,YAAY,CAAC,GAAG,CAAC,OAAO,EAAE,OAAO,CAAC,KAAK,CAAC,CAAC;YAC7C,OAAO;IACL,YAAA,GAAG,EAAA,GAAA;IACH,YAAA,SAAS,EAAE;oBACT,UAAU;oBACV,0BAA2B,CAAA,MAAA,CAAA,UAAU,CAAC,GAAG,CAAE;oBAC3C,yBAAyB;IAC1B,aAAA;aACF,CAAC;SACH,CAAA;QAEO,gBAAY,CAAA,SAAA,CAAA,YAAA,GAApB,UACE,QAA4B,EAAA;IAE5B,QAAA,IAAM,OAAO,GAAG;gBACd,QAAQ,EAAE,UAAC,KAAmB,EAAA;IAC5B,gBAAA,IAAI,OAAO,KAAK,CAAC,IAAI,KAAK,QAAQ,EAAE;wBAClC,OAAO,eAAe,CACpB,IAAI,KAAK,CAAC,sBAAsB,CAAC,CAClC,CAAC;qBACH;IACD,gBAAA,IAAI;wBACF,IAAM,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,IAAc,CAAC,CAAC;IAC9C,oBAAA,IAAI,mBAAmB,CAAC,IAAI,CAAC,EAAE;IAC7B,wBAAA,OAAO,iBAAiB,CAAC,IAAI,CAAC,CAAC;yBAChC;wBACD,OAAO,eAAe,CACpB,IAAI,KAAK,CAAC,sBAAsB,CAAC,CAClC,CAAC;qBACH;oBAAC,OAAO,KAAK,EAAE;wBACd,OAAO,eAAe,CACpB,IAAI,KAAK,CAAC,sBAAsB,CAAC,CAClC,CAAC;qBACH;iBACF;IACD,YAAA,SAAS,EAAE,UAAC,OAAwB,EAAA,EAAK,OAAA,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAA,EAAA;aACjE,CAAC;IAEF,QAAA,OAAO,IAAI,eAAe,CACxB,QAAQ,EACR,OAAO,CACR,CAAC;SACH,CAAA;IAqCM,IAAA,gBAAA,CAAA,SAAA,CAAA,QAAQ,GAAf,YAAA;;;;;;;;IAC8B,wBAAA,EAAA,GAAA,IAAA,EAAA,EAAA,GAAA,aAAA,CAAA,IAAI,CAAC,MAAM,CAAA,CAAA;;;;;4BAAX,EAAW,GAAA,EAAA,CAAA,KAAA,CAAA;4BAAX,EAAW,GAAA,KAAA,CAAA;IAAtB,wBAAA,OAAO,KAAA,CAAA;yDAChB,OAAO,CAAA,CAAA,CAAA;gCAAb,OAAa,CAAA,CAAA,YAAA,EAAA,CAAA,IAAA,EAAA,CAAA,CAAA;;IAAb,wBAAA,EAAA,CAAA,IAAA,EAAa,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;IAEjB,KAAA,CAAA;QAEK,gBAAI,CAAA,SAAA,CAAA,IAAA,GAAV,UAAW,OAAwB,EAAA;;;;gCACjC,OAAM,CAAA,CAAA,YAAA,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CAAA,CAAA;;IAA/B,wBAAA,EAAA,CAAA,IAAA,EAA+B,CAAC;;;;;IACjC,KAAA,CAAA;IAEK,IAAA,gBAAA,CAAA,SAAA,CAAA,KAAK,GAAX,YAAA;;;;IACE,oBAAA,KAAA,CAAA,EAAA,OAAA,CAAA,CAAA,YAAM,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE,CAAA,CAAA;;IAAzB,wBAAA,EAAA,CAAA,IAAA,EAAyB,CAAC;;;;;IAC3B,KAAA,CAAA;QACH,OAAC,gBAAA,CAAA;IAAD,CAAC,EAAA,EAAA;IACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAmTE;;;;;;;;;;;","x_google_ignoreList":[1]}